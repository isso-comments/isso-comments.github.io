<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>API</title>
    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/site.css"/>
    
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="top" title="Isso  documentation" href="../../../" />
    <link rel="next" title="Technical Documentation: Server" href="../../technical-docs/server/" />
    <link rel="prev" title="Multiple Sites &amp; Sub-URI" href="../multi-site-sub-uri/" /> 
</head>
<body>
    <div class="wrapper">
        <div class="header">
            <header>
                <img class="logo" src="../../../_static/isso.svg" alt="Wynaut by @veekun"/>
                <div class="title">
                    <a href="../../.././">
                        <h1>Isso</h1>
                        <h2>a commenting server similar to Disqus</h2>
                    </a>
                </div>
            </header>
            <nav>
                <a href="../../">Documentation</a>
                <a href="../../../news/">News</a>
                <a href="../../contributing/">Contribute</a>
                <a href="../../../community/">community</a>
            </nav>
        </div>

        <div class="outer">
            
    <header>
        <h1>API</h1>
    </header>

        </div>


        <main>
        
    <div class="sidebar">
    
        
    <p class="caption"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../guides/quickstart/">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/tips-and-tricks/">Tips &amp; Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/advanced-integration/">Advanced Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/faq/">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server-config/">Server Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client-config/">Client Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi-site-sub-uri/">Multiple Sites &amp; Sub-URI</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Server API</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../technical-docs/server/">Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical-docs/client/">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical-docs/testing/">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical-docs/testing-client/">Testing the Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical-docs/testing-server/">Testing the Server</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/">Contributing to Isso</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/documentation/">Writing Documentation</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h2>Quick search</h2>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
    
    </div>
    <div class="docs">
          <div class="vcs-edit-container">
          <a href="https://github.com/posativ/isso/blob/master/docs/docs/reference/server-api.rst" class="vcs-edit"><img src="../../../_static/github.svg" /> Edit on GitHub</a>
          </div>
        <div class="section" id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p>The Isso API uses HTTP and JSON as primary communication protocol.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#json-format" id="id1">JSON format</a></li>
<li><a class="reference internal" href="#list-comments" id="id2">List comments</a></li>
<li><a class="reference internal" href="#create-comment" id="id3">Create comment</a></li>
<li><a class="reference internal" href="#edit-comment" id="id4">Edit comment</a></li>
<li><a class="reference internal" href="#delete-comment" id="id5">Delete comment</a></li>
<li><a class="reference internal" href="#up-and-downvote-comments" id="id6">Up- and downvote comments</a></li>
<li><a class="reference internal" href="#get-comment-count" id="id7">Get comment count</a></li>
<li><a class="reference internal" href="#get-atom-feed" id="id8">Get Atom feed</a></li>
</ul>
</div>
<div class="section" id="json-format">
<h3><a class="toc-backref" href="#id1">JSON format</a><a class="headerlink" href="#json-format" title="Permalink to this headline">¶</a></h3>
<p>When querying the API you either get a regular HTTP error, an object or list of
objects representing the comment. Here’s an example JSON returned from
Isso:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;parent&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;p&gt;Hello, World!&lt;/p&gt;\n&quot;</span><span class="p">,</span>
    <span class="nt">&quot;mode&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="nt">&quot;hash&quot;</span><span class="p">:</span> <span class="s2">&quot;4505c1eeda98&quot;</span><span class="p">,</span>
    <span class="nt">&quot;author&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;website&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;created&quot;</span><span class="p">:</span> <span class="mf">1387321261.572392</span><span class="p">,</span>
    <span class="nt">&quot;modified&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;likes&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="nt">&quot;dislikes&quot;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils">
<dt>id :</dt>
<dd>comment id (unique per website).</dd>
<dt>parent :</dt>
<dd>parent id reference, may be <code class="docutils literal notranslate"><span class="pre">null</span></code>.</dd>
<dt>text :</dt>
<dd>required, comment written in Markdown.</dd>
<dt>mode :</dt>
<dd><ul class="first last simple">
<li>1 – accepted</li>
<li>2 – in moderation queue</li>
<li>4 – deleted, but referenced.</li>
</ul>
</dd>
<dt>hash :</dt>
<dd>user identication, used to generate identicons. PBKDF2 from email or IP
address (fallback).</dd>
<dt>author :</dt>
<dd>author’s name, may be <code class="docutils literal notranslate"><span class="pre">null</span></code>.</dd>
<dt>website :</dt>
<dd>author’s website, may be <code class="docutils literal notranslate"><span class="pre">null</span></code>.</dd>
<dt>likes :</dt>
<dd>upvote count, defaults to 0.</dd>
<dt>dislikes :</dt>
<dd>downvote count, defaults to 0.</dd>
<dt>created :</dt>
<dd>time in seconds since UNIX time.</dd>
<dt>modified :</dt>
<dd>last modification since UNIX time, may be <code class="docutils literal notranslate"><span class="pre">null</span></code>.</dd>
</dl>
</div>
<div class="section" id="list-comments">
<h3><a class="toc-backref" href="#id2">List comments</a><a class="headerlink" href="#list-comments" title="Permalink to this headline">¶</a></h3>
<p>List all publicly visible comments for thread <cite>uri</cite>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GET /?uri=%2Fhello-world%2F
</pre></div>
</div>
<dl class="docutils">
<dt>uri :</dt>
<dd>URI to fetch comments for, required.</dd>
<dt>plain :</dt>
<dd>pass plain=1 to get the raw comment text, defaults to 0.</dd>
</dl>
<p>Get the latest N comments for all threads:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GET /latest?limit=N
</pre></div>
</div>
<p>The N parameter limits how many of the latest comments to retrieve; it’s
mandatory, and must be an integer greater than 0.</p>
<p>This endpoint needs to be enabled in the configuration (see the
<code class="docutils literal notranslate"><span class="pre">latest-enabled</span></code> option in the <code class="docutils literal notranslate"><span class="pre">general</span></code> section).</p>
</div>
<div class="section" id="create-comment">
<h3><a class="toc-backref" href="#id3">Create comment</a><a class="headerlink" href="#create-comment" title="Permalink to this headline">¶</a></h3>
<p>To create a new comment, you need to issue a POST request to <code class="docutils literal notranslate"><span class="pre">/new</span></code> and add
the current URI (so the server can check if the location actually exists).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -vX POST http://isso/new?uri<span class="o">=</span>%2F -d <span class="s1">&#39;{&quot;text&quot;: &quot;Hello, World!&quot;}&#39;</span> -H <span class="s2">&quot;Content-Type: application/json&quot;</span>
&lt; HTTP/1.1 <span class="m">201</span> CREATED
&lt; Set-Cookie: <span class="nv">1</span><span class="o">=</span>...<span class="p">;</span> <span class="nv">Expires</span><span class="o">=</span>Wed, <span class="m">18</span>-Dec-2013 <span class="m">12</span>:57:20 GMT<span class="p">;</span> Max-Age<span class="o">=</span><span class="m">900</span><span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/
<span class="o">{</span>
    <span class="s2">&quot;author&quot;</span>: null,
    <span class="s2">&quot;created&quot;</span>: <span class="m">1387370540</span>.733824,
    <span class="s2">&quot;dislikes&quot;</span>: <span class="m">0</span>,
    <span class="s2">&quot;email&quot;</span>: null,
    <span class="s2">&quot;hash&quot;</span>: <span class="s2">&quot;6dcdbfb4f00d&quot;</span>,
    <span class="s2">&quot;id&quot;</span>: <span class="m">1</span>,
    <span class="s2">&quot;likes&quot;</span>: <span class="m">0</span>,
    <span class="s2">&quot;mode&quot;</span>: <span class="m">1</span>,
    <span class="s2">&quot;modified&quot;</span>: null,
    <span class="s2">&quot;parent&quot;</span>: null,
    <span class="s2">&quot;text&quot;</span>: <span class="s2">&quot;&lt;p&gt;Hello, World!&lt;/p&gt;\n&quot;</span>,
    <span class="s2">&quot;website&quot;</span>: null
<span class="o">}</span>
</pre></div>
</div>
<p>The payload must be valid JSON. To prevent CSRF attacks, you must set the
<cite>Content-Type</cite> to <cite>application/json</cite> or omit the header completely.</p>
<p>The server issues a cookie per new comment which acts as authentication token
to modify or delete your own comment. The token is cryptographically signed
and expires automatically after 900 seconds by default.</p>
<p>The following keys can be used to POST a new comment, all other fields are
dropped or replaced with values from the server:</p>
<dl class="docutils">
<dt>text <span class="classifier-delimiter">:</span> <span class="classifier">String</span></dt>
<dd>Actual comment, at least three characters long, required.</dd>
<dt>author <span class="classifier-delimiter">:</span> <span class="classifier">String</span></dt>
<dd>Comment author, optional.</dd>
<dt>website <span class="classifier-delimiter">:</span> <span class="classifier">String</span></dt>
<dd>Commenter’s website (currently no field available in the client JS though),
optional.</dd>
<dt>email <span class="classifier-delimiter">:</span> <span class="classifier">String</span></dt>
<dd>Commenter’s email address (can be any arbitrary string though) used to
generate the identicon. Limited to 254 characters (RFC specification),
optional.</dd>
<dt>parent <span class="classifier-delimiter">:</span> <span class="classifier">Integer</span></dt>
<dd>Reference to parent comment, optional.</dd>
</dl>
</div>
<div class="section" id="edit-comment">
<h3><a class="toc-backref" href="#id4">Edit comment</a><a class="headerlink" href="#edit-comment" title="Permalink to this headline">¶</a></h3>
<p>When your authentication token is not yet expired, you can issue a PUT request
to update <cite>text</cite>, <cite>author</cite> and <cite>website</cite>. After an update, you get an updated
authentication token and the comment as JSON:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -X PUT http://isso/id/1 -d <span class="s2">&quot;...&quot;</span> -H <span class="s2">&quot;Content-Type: application/json&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-comment">
<h3><a class="toc-backref" href="#id5">Delete comment</a><a class="headerlink" href="#delete-comment" title="Permalink to this headline">¶</a></h3>
<p>You can delete your own comments when your authentication token (= cookie) is
not yet expired:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -X DELETE http://isso/id/1 -H <span class="s2">&quot;Content-Type: application/json&quot;</span>
null
</pre></div>
</div>
<p>Returns either <cite>null</cite> or a comment with an empty text value when the comment
is still referenced by other comments.</p>
</div>
<div class="section" id="up-and-downvote-comments">
<h3><a class="toc-backref" href="#id6">Up- and downvote comments</a><a class="headerlink" href="#up-and-downvote-comments" title="Permalink to this headline">¶</a></h3>
<p>…</p>
</div>
<div class="section" id="get-comment-count">
<h3><a class="toc-backref" href="#id7">Get comment count</a><a class="headerlink" href="#get-comment-count" title="Permalink to this headline">¶</a></h3>
<p>Counts all publicly visible comments for thread <cite>uri</cite>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GET /count?uri=%2Fhello-world%2F
2
</pre></div>
</div>
<dl class="docutils">
<dt>uri :</dt>
<dd>URI to count comments for, required.</dd>
</dl>
<p>returns an integer</p>
</div>
<div class="section" id="get-atom-feed">
<h3><a class="toc-backref" href="#id8">Get Atom feed</a><a class="headerlink" href="#get-atom-feed" title="Permalink to this headline">¶</a></h3>
<p>Get an Atom feed of comments for thread <cite>uri</cite>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>GET /feed?uri=%2Fhello-world%2F
</pre></div>
</div>
<dl class="docutils">
<dt>uri :</dt>
<dd>URI to get comments for, required.</dd>
</dl>
<p>Returns an XML document as the Atom feed.</p>
</div>
</div>

    </div>

        </main>

        <div class="push"></div>
    </div>

    <div class="outer footer">
        <footer>
        &copy; Copyright 2022, Martin Zimmermann & contributors.

        Made with <a href="http://sphinx-doc.org/">Sphinx</a>.
        </footer>
    </div>
  </body>
</html>